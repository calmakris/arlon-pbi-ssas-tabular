{
  "name": "Avg Monthly Inventory Consumption Quantity Last 3 Months New",
  "description": "Monthly average of sum of 'Inventory Consumption'[Quantity] posted in the previous 3 calendar months. Can be toggled between quantity and amount values (default = quantity).",
  "expression": [
    "",
    "VAR _NumOfMonths = 3",
    "VAR _MaxDate =",
    "    CALCULATE(",
    "        MAX(Calendar[Start of Month]),",
    "        FILTER(",
    "            ALL( Calendar ),",
    "            Calendar[Date] <= [Report Date]",
    "        )",
    "    )",
    "VAR _MinDate = EDATE(_MaxDate, -_NumOfMonths)",
    "",
    "",
    " VAR AMU = CALCULATE(",
    "            DIVIDE( ABS( SUM( 'Inventory Consumption'[Quantity] ) + 0 ), _NumOfMonths ),",
    "            FILTER(",
    "                ALL( Calendar[Date] ),",
    "                Calendar[Date] >= _MinDate",
    "                    && Calendar[Date] < _MaxDate",
    "            )",
    "        )",
    "    ",
    "  ",
    "RETURN",
    "    IF(",
    "        AMU = 0,",
    "        BLANK(),",
    "        AMU",
    "    )"
  ],
  "formatString": "#,##0.00",
  "displayFolder": "Inventory\\_Consumption"
}
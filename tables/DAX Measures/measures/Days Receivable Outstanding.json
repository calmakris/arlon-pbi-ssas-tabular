{
  "name": "Days Receivable Outstanding",
  "description": "This calculates average number of days it takes to collect receivables based on the previous 12 calendar months. A high days figure can indicate that the company is taking too long to collect money, and the company is extending too lenient credit terms to customers.",
  "expression": [
    "",
    "VAR _MinVisibleDate =",
    "    MIN( 'Calendar'[Date] )",
    "",
    "VAR _RefDate =",
    "    CALCULATE(",
    "        MAX( 'Calendar'[Date] ),",
    "        FILTER(",
    "            'Calendar',",
    "            'Calendar'[Date] <= [Report Date]",
    "        )",
    "    )",
    "",
    "VAR _MaxDate =",
    "    EOMONTH( _RefDate, -1 )",
    "",
    "VAR _MinDate =",
    "    EOMONTH( _RefDate, -13 ) + 1",
    "",
    "VAR _DaysDiff =",
    "    DATEDIFF( _MinDate, _MaxDate, DAY )",
    "",
    "VAR _OpenAR =",
    "    AVERAGEX(",
    "        SUMMARIZE(",
    "            FILTER(",
    "                ALL( 'Calendar' ),",
    "                'Calendar'[Date] >= _MinDate",
    "                    && 'Calendar'[Date] <= _MaxDate",
    "            ),",
    "            'Calendar'[Year_Month_Sort_Key],",
    "            \"Open\",",
    "                CALCULATE(",
    "                    SUM( 'Accounts Receivable'[AmountUSD] ),",
    "                    FILTER(",
    "                        ALL( 'Calendar' ),",
    "                        'Calendar'[Date] <= _RefDate",
    "                    ),",
    "                    FILTER(",
    "                        ALL( 'Accounts Receivable' ),",
    "                        'Accounts Receivable'[Cleared Date] > _RefDate",
    "                    )",
    "                )",
    "        ),",
    "        [Open]",
    "    )",
    "",
    "VAR _GrossSales =",
    "    CALCULATE(",
    "        [Gross Sales],",
    "        FILTER(",
    "            ALL( 'Calendar'[Date] ),",
    "            'Calendar'[Date] >= _MinDate",
    "                && 'Calendar'[Date] <= _MaxDate",
    "        )",
    "    )",
    "",
    "RETURN",
    "    IF(",
    "        _MinVisibleDate <= [Report Date],",
    "        DIVIDE(",
    "            _OpenAR,",
    "            _GrossSales",
    "        ) * _DaysDiff",
    "    )"
  ],
  "formatString": "#,0.0",
  "displayFolder": "Finance",
  "annotations": [
    {
      "name": "TabularEditor_InPerspective",
      "value": "[\"Finance\"]"
    }
  ]
}
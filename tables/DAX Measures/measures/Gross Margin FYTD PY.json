{
  "name": "Gross Margin FYTD PY",
  "description": "Fiscal year-to-date total of gross margin of previous fiscal year up to the same current period to the day",
  "expression": [
    "",
    "VAR _ReportDate =",
    "    CALCULATE(",
    "        MAX( 'Calendar'[Date] ),",
    "        FILTER( ALL('Calendar'), 'Calendar'[Date] <= [Report Date] )",
    "    )",
    "    ",
    "VAR _BegYear =",
    "    CALCULATE(",
    "        MAX( 'Calendar'[Date] ),",
    "        FILTER( ALL('Calendar'), 'Calendar'[Date] <= [Beginning of Fiscal Year] )",
    "    )",
    "",
    "VAR _DayofFiscal =",
    "    DATEDIFF( _BegYear, _ReportDate, DAY ) + 1",
    "",
    "RETURN",
    "    CALCULATE(",
    "        CALCULATE(",
    "            CALCULATE(",
    "                [Gross Margin],",
    "                FILTER(",
    "                    'Calendar',",
    "                    'Calendar'[Day of Fiscal Year] <= _DayofFiscal",
    "                )",
    "            ),",
    "            SAMEPERIODLASTYEAR(DATESYTD( 'Calendar'[Date], \"09/30\" ))",
    "        ),",
    "        FILTER(",
    "            'Calendar',",
    "            'Calendar'[Date] <= [Report Date]",
    "        )",
    "    )"
  ],
  "formatString": "#,0",
  "displayFolder": "Sales Invoice\\_Time-Based",
  "annotations": [
    {
      "name": "TabularEditor_InPerspective",
      "value": "[\"BI Morning Dashboard\",\"Finance\",\"Generic Sales\"]"
    }
  ]
}
{
  "name": "Inventory Net Turns",
  "description": "This measure calculates the inventory turnover ratio over the previous three months, based on the cost of goods sold (COGS) and the average end-of-month inventory value. It annualizes the COGS for the last three months and divides this by the average of the inventory values at the end of each month in the period, normalizing this ratio to a per-month basis. This ratio is a critical measure of warehouse efficiency, indicating how quickly inventory is sold and replaced.",
  "expression": [
    "",
    "-- End of last month",
    "VAR _LastDate =",
    "    EOMONTH(",
    "        CALCULATE(",
    "            MAX('Calendar'[Date]),",
    "            FILTER(",
    "                'Calendar',",
    "                'Calendar'[Date] <= [Report Date]",
    "            )",
    "        ),",
    "        -1",
    "    )",
    "",
    "-- Beginning of month 3 calendar months ago",
    "VAR _FirstDate =",
    "    EOMONTH ( _LastDate, -4 ) + 1",
    "",
    "-- COGS of last 3 months times 4",
    "VAR _AnnualizedCOGS =",
    "    CALCULATE(",
    "        [Cost of Goods Sold],",
    "        FILTER(",
    "            ALL( 'Calendar' ),",
    "            'Calendar'[Date] >= _FirstDate",
    "                && 'Calendar'[Date] <= _LastDate",
    "        )",
    "    ) * 4",
    "",
    "-- Monthly avg of closing inventory balance in last 3 months",
    "VAR _AvgInventory =",
    "    AVERAGEX(",
    "        SUMMARIZE(",
    "            FILTER(",
    "                ALL( 'Calendar' ),",
    "                'Calendar'[Date] >= _FirstDate",
    "                    && 'Calendar'[Date] <= EOMONTH( _LastDate, -1 )",
    "            ),",
    "            'Calendar'[Year_Month_Sort_Key],",
    "            \"ClosingBalance\", [Inventory Snapshot Amount with Adjustments]",
    "        ),",
    "        [ClosingBalance]",
    "    )",
    "",
    "RETURN",
    "DIVIDE(",
    "    _AnnualizedCOGS,",
    "    _AvgInventory",
    ")"
  ],
  "formatString": "#,0.00",
  "displayFolder": "Inventory",
  "annotations": [
    {
      "name": "TabularEditor_InPerspective",
      "value": "[\"Inventory\",\"Operations\",\"Planning\"]"
    }
  ]
}